// Generated by CoffeeScript 1.3.3
var app, echonest, express, http, io, nest, server, spotify;

express = require('express');

spotify = require('spotify');

echonest = require('echonest');

http = require('http');

app = express();

io = require('socket.io');

server = http.createServer(app);

io = io.listen(server);

app.listen(3000);

app.use(express["static"](__dirname + '/static'));

app.use(express.bodyParser());

nest = new echonest.Echonest({
  api_key: 'PCG7Z9OEOD91S20SU'
});

io.sockets.on('connection', function(socket) {
  return console.log(socket);
});

/*
spotify.get  '/lookup/1/.json?uri=spotify:artist:4YrKBkKSVeqDamzBPWVnSJ', (err, res) ->
	console.log res
*/


app.post('/search', function(req, res) {
  return nest.song.search({
    combined: 'Above & beyond Good for me',
    results: '3',
    bucket: ['id:spotify-WW', 'tracks']
  }, function(error, response) {
    return res.json(response.songs);
  });
});

/*
app.post '/search', (req, res) ->
	console.log req.body.query, req.body.type
	spotify.search { type: 'track',	query: req.body.query }, (err, data) ->
		if err
			console.log 'Error', err
		else
			#console.log err, data
			res.json data.tracks.slice(0, 10);

	#res.json hoi
*/

